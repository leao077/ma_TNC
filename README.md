# ma_TNC
ma_TNC is a multi-amplitude tensor network contraction method. On the algorithmic side, we propose an improved loss function that searches for the optimal tensor network contraction order in terms of a minimized total complexity when reusing intermediate results among multiple amplitudes. We also provide a static caching strategy that identifies and stores the reusable results in such a way that minimizes both the compute cost and the memory overhead. On the implementation side, we build our simulator with a fused tensor network contraction algorithm to largely reduce data movement and increase compute density. We complete the simulation of three million random amplitude samples based on this method.

Different from the previous work, we need to store some intermediate tensors, so we managed a rising-up representation for the contraction path. If the tensor network originally have n tensors, after the k-th contraction in which tensor i and j are contracted, the generated tensor will be put at the location n+k. This representation provide convenience for us to determine the position of stored tensors. In this work, we open all the output legs in order to do assignment for different amplitudes. As a result, the number of tensors will be larger than single-amplitude tensor network contraction(sa_TNC). The ma_TNC of Sycamore(m=20) have 402 tensors originally.

We provide the experimental data in the folder simulation_data, which consists of three parts: the quantum circuit to sample from (circuit_n53_m20_s0_e0_pABCDCDAB.qsim), the simulation results (amps3M.zip, which contains the three million bitstrings together with the calculated amplitudes), and the folder path_info which contains the underlying tensor network to produce those amplitudes (arrays.txt) and the contraction path information (sliced.txt).
